<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Restaurant: /home/francisco/Desktop/SO/projeto2/semaphore_restaurant/src/semSharedMemClient.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Restaurant
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Implementation based on shared memory and semaphores</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('sem_shared_mem_client_8c.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">semSharedMemClient.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Problem name: Restaurant.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="prob_const_8h_source.html">probConst.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="prob_data_struct_8h_source.html">probDataStruct.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="logging_8h_source.html">logging.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="shared_data_sync_8h_source.html">sharedDataSync.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="semaphore_8h_source.html">semaphore.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="shared_memory_8h_source.html">sharedMemory.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af3c93014cab49d1ad233a3734568ba02"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sem_shared_mem_client_8c.html#af3c93014cab49d1ad233a3734568ba02">waitFriends</a> (int id)</td></tr>
<tr class="memdesc:af3c93014cab49d1ad233a3734568ba02"><td class="mdescLeft">&#160;</td><td class="mdescRight">client waits until table is complete  <a href="#af3c93014cab49d1ad233a3734568ba02">More...</a><br /></td></tr>
<tr class="separator:af3c93014cab49d1ad233a3734568ba02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae059cbaf1a46cfb6ea1dc4b306dbdd8a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sem_shared_mem_client_8c.html#ae059cbaf1a46cfb6ea1dc4b306dbdd8a">orderFood</a> (int id)</td></tr>
<tr class="memdesc:ae059cbaf1a46cfb6ea1dc4b306dbdd8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">first client orders food.  <a href="#ae059cbaf1a46cfb6ea1dc4b306dbdd8a">More...</a><br /></td></tr>
<tr class="separator:ae059cbaf1a46cfb6ea1dc4b306dbdd8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9af77f96655a91cea1bfa916db5d4ef"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sem_shared_mem_client_8c.html#aa9af77f96655a91cea1bfa916db5d4ef">waitFood</a> (int id)</td></tr>
<tr class="memdesc:aa9af77f96655a91cea1bfa916db5d4ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">client waits for food.  <a href="#aa9af77f96655a91cea1bfa916db5d4ef">More...</a><br /></td></tr>
<tr class="separator:aa9af77f96655a91cea1bfa916db5d4ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab6d2c1815a7172d7c999b062f93c7ce"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sem_shared_mem_client_8c.html#aab6d2c1815a7172d7c999b062f93c7ce">travel</a> (int id)</td></tr>
<tr class="memdesc:aab6d2c1815a7172d7c999b062f93c7ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">client goes to restaurant  <a href="#aab6d2c1815a7172d7c999b062f93c7ce">More...</a><br /></td></tr>
<tr class="separator:aab6d2c1815a7172d7c999b062f93c7ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c70d26df2e54d70da6840df738d5fb5"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sem_shared_mem_client_8c.html#a5c70d26df2e54d70da6840df738d5fb5">eat</a> (int id)</td></tr>
<tr class="memdesc:a5c70d26df2e54d70da6840df738d5fb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">client eats  <a href="#a5c70d26df2e54d70da6840df738d5fb5">More...</a><br /></td></tr>
<tr class="separator:a5c70d26df2e54d70da6840df738d5fb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75ed7bfcd014c7e95f9eb3bcc1edffcd"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sem_shared_mem_client_8c.html#a75ed7bfcd014c7e95f9eb3bcc1edffcd">waitAndPay</a> (int id)</td></tr>
<tr class="memdesc:a75ed7bfcd014c7e95f9eb3bcc1edffcd"><td class="mdescLeft">&#160;</td><td class="mdescRight">client waits for others to finish meal, last client to arrive pays the bill.  <a href="#a75ed7bfcd014c7e95f9eb3bcc1edffcd">More...</a><br /></td></tr>
<tr class="separator:a75ed7bfcd014c7e95f9eb3bcc1edffcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sem_shared_mem_client_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
<tr class="memdesc:a0ddf1224851353fc92bfbff6f499fa97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main program.  <a href="#a0ddf1224851353fc92bfbff6f499fa97">More...</a><br /></td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:acfacf4afc970672f2e32e3d997e99add"><td class="memItemLeft" align="right" valign="top"><a id="acfacf4afc970672f2e32e3d997e99add"></a>
static char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sem_shared_mem_client_8c.html#acfacf4afc970672f2e32e3d997e99add">nFic</a> [51]</td></tr>
<tr class="memdesc:acfacf4afc970672f2e32e3d997e99add"><td class="mdescLeft">&#160;</td><td class="mdescRight">logging file name <br /></td></tr>
<tr class="separator:acfacf4afc970672f2e32e3d997e99add"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8807d215d2ee6d9779d76aeb1147430"><td class="memItemLeft" align="right" valign="top"><a id="ac8807d215d2ee6d9779d76aeb1147430"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sem_shared_mem_client_8c.html#ac8807d215d2ee6d9779d76aeb1147430">shmid</a></td></tr>
<tr class="memdesc:ac8807d215d2ee6d9779d76aeb1147430"><td class="mdescLeft">&#160;</td><td class="mdescRight">shared memory block access identifier <br /></td></tr>
<tr class="separator:ac8807d215d2ee6d9779d76aeb1147430"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca4cf1b2018a791b8c1aefb7a25091bc"><td class="memItemLeft" align="right" valign="top"><a id="aca4cf1b2018a791b8c1aefb7a25091bc"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sem_shared_mem_client_8c.html#aca4cf1b2018a791b8c1aefb7a25091bc">semgid</a></td></tr>
<tr class="memdesc:aca4cf1b2018a791b8c1aefb7a25091bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">semaphore set access identifier <br /></td></tr>
<tr class="separator:aca4cf1b2018a791b8c1aefb7a25091bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35717cefd81dd12800127c29feea37a8"><td class="memItemLeft" align="right" valign="top"><a id="a35717cefd81dd12800127c29feea37a8"></a>
static <a class="el" href="struct_s_h_a_r_e_d___d_a_t_a.html">SHARED_DATA</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sem_shared_mem_client_8c.html#a35717cefd81dd12800127c29feea37a8">sh</a></td></tr>
<tr class="memdesc:a35717cefd81dd12800127c29feea37a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">pointer to shared memory region <br /></td></tr>
<tr class="separator:a35717cefd81dd12800127c29feea37a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Problem name: Restaurant. </p>
<p>(implementation file)</p>
<p>Synchronization based on semaphores and shared memory. Implementation with SVIPC.</p>
<p>Definition of the operations carried out by the clients: </p><ul>
<li>waitFriends </li>
<li>orderFood </li>
<li>waitFood </li>
<li>travel </li>
<li>eat </li>
<li>waitAndPay</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Nuno Lau - November 2017 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a5c70d26df2e54d70da6840df738d5fb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c70d26df2e54d70da6840df738d5fb5">&#9670;&nbsp;</a></span>eat()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void eat </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>client eats </p>
<p>The client takes his time to eat a pleasant dinner.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>client id </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0ddf1224851353fc92bfbff6f499fa97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ddf1224851353fc92bfbff6f499fa97">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main program. </p>
<p>Its role is to generate the life cycle of one of intervening entities in the problem: the client. </p>

</div>
</div>
<a id="ae059cbaf1a46cfb6ea1dc4b306dbdd8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae059cbaf1a46cfb6ea1dc4b306dbdd8a">&#9670;&nbsp;</a></span>orderFood()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void orderFood </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>first client orders food. </p>
<p>This function is used only by the first client. The first client should update its state, request food to the waiter and wait for the waiter to receive the request.</p>
<p>The internal state should be saved.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>client id </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aab6d2c1815a7172d7c999b062f93c7ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab6d2c1815a7172d7c999b062f93c7ce">&#9670;&nbsp;</a></span>travel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void travel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>client goes to restaurant </p>
<p>The client takes his time to get to restaurant.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>client id </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a75ed7bfcd014c7e95f9eb3bcc1edffcd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75ed7bfcd014c7e95f9eb3bcc1edffcd">&#9670;&nbsp;</a></span>waitAndPay()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void waitAndPay </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>client waits for others to finish meal, last client to arrive pays the bill. </p>
<p>The client updates state and waits for others to finish meal before leaving and update its state. Last client to finish meal should inform others that everybody finished. Last client to arrive at table should pay the bill by contacting waiter and waiting for waiter to arrive. The internal state should be saved twice.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>client id </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa9af77f96655a91cea1bfa916db5d4ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9af77f96655a91cea1bfa916db5d4ef">&#9670;&nbsp;</a></span>waitFood()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void waitFood </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>client waits for food. </p>
<p>The client updates its state, and waits until food arrives. It should also update state after food arrives. The internal state should be saved twice.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>client id </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af3c93014cab49d1ad233a3734568ba02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3c93014cab49d1ad233a3734568ba02">&#9670;&nbsp;</a></span>waitFriends()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool waitFriends </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>client waits until table is complete </p>
<p>Client should udpate state, first and last clients should register their values in shared data, last client should, in addition, inform the others that the table is complete. Client must wait in this function until the table is complete. The internal state should be saved.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>client id</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if first client, false otherwise </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="sem_shared_mem_client_8c.html">semSharedMemClient.c</a></li>
    <li class="footer">Generated on Tue Dec 12 2017 19:46:06 for Restaurant by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
